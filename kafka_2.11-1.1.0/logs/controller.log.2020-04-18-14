[2020-04-18 14:07:14,923] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@66d3c617, name=log4j:logger=kafka.controller (kafka.controller)
[2020-04-18 14:07:48,303] INFO [ControllerEventThread controllerId=0] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-04-18 14:07:48,320] INFO [Controller id=0] 0 successfully elected as the controller (kafka.controller.KafkaController)
[2020-04-18 14:07:48,320] INFO [Controller id=0] Reading controller epoch from ZooKeeper (kafka.controller.KafkaController)
[2020-04-18 14:07:48,324] INFO [Controller id=0] Initialized controller epoch to 73 and zk version 72 (kafka.controller.KafkaController)
[2020-04-18 14:07:48,324] INFO [Controller id=0] Incrementing controller epoch in ZooKeeper (kafka.controller.KafkaController)
[2020-04-18 14:07:48,332] INFO [Controller id=0] Epoch incremented to 74 (kafka.controller.KafkaController)
[2020-04-18 14:07:48,333] INFO [Controller id=0] Registering handlers (kafka.controller.KafkaController)
[2020-04-18 14:07:48,343] INFO [Controller id=0] Deleting log dir event notifications (kafka.controller.KafkaController)
[2020-04-18 14:07:48,345] INFO [Controller id=0] Deleting isr change notifications (kafka.controller.KafkaController)
[2020-04-18 14:07:48,349] INFO [Controller id=0] Initializing controller context (kafka.controller.KafkaController)
[2020-04-18 14:07:48,417] DEBUG [Controller id=0] Register BrokerModifications handler for Set(0) (kafka.controller.KafkaController)
[2020-04-18 14:07:48,434] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2020-04-18 14:07:48,447] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2020-04-18 14:07:48,452] INFO [Controller id=0] Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2020-04-18 14:07:48,453] INFO [Controller id=0] Currently active brokers in the cluster: Set(0) (kafka.controller.KafkaController)
[2020-04-18 14:07:48,453] INFO [Controller id=0] Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2020-04-18 14:07:48,453] INFO [Controller id=0] Current list of topics in the cluster: Set(customerProfile, sellerProfileService, response_topic, passport, profile, sellerProductService, customerProductService, response_topic_amazon, accounts) (kafka.controller.KafkaController)
[2020-04-18 14:07:48,454] INFO [Controller id=0] Fetching topic deletions in progress (kafka.controller.KafkaController)
[2020-04-18 14:07:48,457] INFO [Controller id=0] List of topics to be deleted:  (kafka.controller.KafkaController)
[2020-04-18 14:07:48,457] INFO [Controller id=0] List of topics ineligible for deletion:  (kafka.controller.KafkaController)
[2020-04-18 14:07:48,457] INFO [Controller id=0] Initializing topic deletion manager (kafka.controller.KafkaController)
[2020-04-18 14:07:48,459] INFO [Controller id=0] Sending update metadata request (kafka.controller.KafkaController)
[2020-04-18 14:07:48,479] INFO [ReplicaStateMachine controllerId=0] Initializing replica state (kafka.controller.ReplicaStateMachine)
[2020-04-18 14:07:48,486] INFO [ReplicaStateMachine controllerId=0] Triggering online replica state changes (kafka.controller.ReplicaStateMachine)
[2020-04-18 14:07:48,490] INFO [RequestSendThread controllerId=0] Controller 0 connected to localhost:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2020-04-18 14:07:48,548] INFO [ReplicaStateMachine controllerId=0] Started replica state machine with initial state -> Map([Topic=response_topic_amazon,Partition=0,Replica=0] -> OnlineReplica, [Topic=customerProductService,Partition=0,Replica=0] -> OnlineReplica, [Topic=customerProfile,Partition=0,Replica=0] -> OnlineReplica, [Topic=sellerProfileService,Partition=0,Replica=0] -> OnlineReplica, [Topic=accounts,Partition=0,Replica=0] -> OnlineReplica, [Topic=sellerProductService,Partition=0,Replica=0] -> OnlineReplica, [Topic=response_topic,Partition=0,Replica=0] -> OnlineReplica, [Topic=passport,Partition=0,Replica=0] -> OnlineReplica, [Topic=profile,Partition=0,Replica=0] -> OnlineReplica) (kafka.controller.ReplicaStateMachine)
[2020-04-18 14:07:48,548] INFO [PartitionStateMachine controllerId=0] Initializing partition state (kafka.controller.PartitionStateMachine)
[2020-04-18 14:07:48,551] INFO [PartitionStateMachine controllerId=0] Triggering online partition state changes (kafka.controller.PartitionStateMachine)
[2020-04-18 14:07:48,579] INFO [PartitionStateMachine controllerId=0] Started partition state machine with initial state -> Map(sellerProfileService-0 -> OnlinePartition, customerProfile-0 -> OnlinePartition, passport-0 -> OnlinePartition, sellerProductService-0 -> OnlinePartition, profile-0 -> OnlinePartition, customerProductService-0 -> OnlinePartition, response_topic_amazon-0 -> OnlinePartition, response_topic-0 -> OnlinePartition, accounts-0 -> OnlinePartition) (kafka.controller.PartitionStateMachine)
[2020-04-18 14:07:48,579] INFO [Controller id=0] Ready to serve as the new controller with epoch 74 (kafka.controller.KafkaController)
[2020-04-18 14:07:48,585] INFO [Controller id=0] Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2020-04-18 14:07:48,586] INFO [Controller id=0] Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2020-04-18 14:07:48,587] INFO [Controller id=0] Skipping preferred replica election for partitions due to topic deletion:  (kafka.controller.KafkaController)
[2020-04-18 14:07:48,587] INFO [Controller id=0] Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2020-04-18 14:07:48,588] INFO [Controller id=0] Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2020-04-18 14:07:48,599] INFO [Controller id=0] Starting the controller scheduler (kafka.controller.KafkaController)
[2020-04-18 14:07:53,610] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2020-04-18 14:07:53,612] DEBUG [Controller id=0] Preferred replicas by broker Map(0 -> Map(sellerProfileService-0 -> Vector(0), customerProfile-0 -> Vector(0), passport-0 -> Vector(0), sellerProductService-0 -> Vector(0), profile-0 -> Vector(0), customerProductService-0 -> Vector(0), response_topic_amazon-0 -> Vector(0), response_topic-0 -> Vector(0), accounts-0 -> Vector(0))) (kafka.controller.KafkaController)
[2020-04-18 14:07:53,625] DEBUG [Controller id=0] Topics not in preferred replica for broker 0 Map() (kafka.controller.KafkaController)
[2020-04-18 14:07:53,626] TRACE [Controller id=0] Leader imbalance ratio for broker 0 is 0.0 (kafka.controller.KafkaController)
[2020-04-18 14:12:53,633] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2020-04-18 14:12:53,637] DEBUG [Controller id=0] Preferred replicas by broker Map(0 -> Map(sellerProfileService-0 -> Vector(0), customerProfile-0 -> Vector(0), passport-0 -> Vector(0), sellerProductService-0 -> Vector(0), profile-0 -> Vector(0), customerProductService-0 -> Vector(0), response_topic_amazon-0 -> Vector(0), response_topic-0 -> Vector(0), accounts-0 -> Vector(0))) (kafka.controller.KafkaController)
[2020-04-18 14:12:53,638] DEBUG [Controller id=0] Topics not in preferred replica for broker 0 Map() (kafka.controller.KafkaController)
[2020-04-18 14:12:53,638] TRACE [Controller id=0] Leader imbalance ratio for broker 0 is 0.0 (kafka.controller.KafkaController)
[2020-04-18 14:17:53,646] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2020-04-18 14:17:53,652] DEBUG [Controller id=0] Preferred replicas by broker Map(0 -> Map(sellerProfileService-0 -> Vector(0), customerProfile-0 -> Vector(0), passport-0 -> Vector(0), sellerProductService-0 -> Vector(0), profile-0 -> Vector(0), customerProductService-0 -> Vector(0), response_topic_amazon-0 -> Vector(0), response_topic-0 -> Vector(0), accounts-0 -> Vector(0))) (kafka.controller.KafkaController)
[2020-04-18 14:17:53,652] DEBUG [Controller id=0] Topics not in preferred replica for broker 0 Map() (kafka.controller.KafkaController)
[2020-04-18 14:17:53,652] TRACE [Controller id=0] Leader imbalance ratio for broker 0 is 0.0 (kafka.controller.KafkaController)
[2020-04-18 14:22:53,660] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2020-04-18 14:22:53,664] DEBUG [Controller id=0] Preferred replicas by broker Map(0 -> Map(sellerProfileService-0 -> Vector(0), customerProfile-0 -> Vector(0), passport-0 -> Vector(0), sellerProductService-0 -> Vector(0), profile-0 -> Vector(0), customerProductService-0 -> Vector(0), response_topic_amazon-0 -> Vector(0), response_topic-0 -> Vector(0), accounts-0 -> Vector(0))) (kafka.controller.KafkaController)
[2020-04-18 14:22:53,664] DEBUG [Controller id=0] Topics not in preferred replica for broker 0 Map() (kafka.controller.KafkaController)
[2020-04-18 14:22:53,666] TRACE [Controller id=0] Leader imbalance ratio for broker 0 is 0.0 (kafka.controller.KafkaController)
[2020-04-18 14:27:53,675] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2020-04-18 14:27:53,682] DEBUG [Controller id=0] Preferred replicas by broker Map(0 -> Map(sellerProfileService-0 -> Vector(0), customerProfile-0 -> Vector(0), passport-0 -> Vector(0), sellerProductService-0 -> Vector(0), profile-0 -> Vector(0), customerProductService-0 -> Vector(0), response_topic_amazon-0 -> Vector(0), response_topic-0 -> Vector(0), accounts-0 -> Vector(0))) (kafka.controller.KafkaController)
[2020-04-18 14:27:53,682] DEBUG [Controller id=0] Topics not in preferred replica for broker 0 Map() (kafka.controller.KafkaController)
[2020-04-18 14:27:53,682] TRACE [Controller id=0] Leader imbalance ratio for broker 0 is 0.0 (kafka.controller.KafkaController)
[2020-04-18 14:30:04,408] INFO [Controller id=0] New topics: [Set(adminProductService)], deleted topics: [Set()], new partition replica assignment [Map(adminProductService-0 -> Vector(0))] (kafka.controller.KafkaController)
[2020-04-18 14:30:04,414] INFO [Controller id=0] New partition creation callback for adminProductService-0 (kafka.controller.KafkaController)
[2020-04-18 14:30:04,453] INFO [RequestSendThread controllerId=0] Controller 0 connected to localhost:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2020-04-18 14:32:53,692] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2020-04-18 14:32:53,700] DEBUG [Controller id=0] Preferred replicas by broker Map(0 -> Map(sellerProfileService-0 -> Vector(0), adminProductService-0 -> Vector(0), customerProfile-0 -> Vector(0), sellerProductService-0 -> Vector(0), passport-0 -> Vector(0), profile-0 -> Vector(0), response_topic_amazon-0 -> Vector(0), customerProductService-0 -> Vector(0), accounts-0 -> Vector(0), response_topic-0 -> Vector(0))) (kafka.controller.KafkaController)
[2020-04-18 14:32:53,700] DEBUG [Controller id=0] Topics not in preferred replica for broker 0 Map() (kafka.controller.KafkaController)
[2020-04-18 14:32:53,700] TRACE [Controller id=0] Leader imbalance ratio for broker 0 is 0.0 (kafka.controller.KafkaController)
[2020-04-18 14:37:53,712] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2020-04-18 14:37:53,719] DEBUG [Controller id=0] Preferred replicas by broker Map(0 -> Map(sellerProfileService-0 -> Vector(0), adminProductService-0 -> Vector(0), customerProfile-0 -> Vector(0), sellerProductService-0 -> Vector(0), passport-0 -> Vector(0), profile-0 -> Vector(0), response_topic_amazon-0 -> Vector(0), customerProductService-0 -> Vector(0), accounts-0 -> Vector(0), response_topic-0 -> Vector(0))) (kafka.controller.KafkaController)
[2020-04-18 14:37:53,719] DEBUG [Controller id=0] Topics not in preferred replica for broker 0 Map() (kafka.controller.KafkaController)
[2020-04-18 14:37:53,719] TRACE [Controller id=0] Leader imbalance ratio for broker 0 is 0.0 (kafka.controller.KafkaController)
[2020-04-18 14:42:53,723] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2020-04-18 14:42:53,724] DEBUG [Controller id=0] Preferred replicas by broker Map(0 -> Map(sellerProfileService-0 -> Vector(0), adminProductService-0 -> Vector(0), customerProfile-0 -> Vector(0), sellerProductService-0 -> Vector(0), passport-0 -> Vector(0), profile-0 -> Vector(0), response_topic_amazon-0 -> Vector(0), customerProductService-0 -> Vector(0), accounts-0 -> Vector(0), response_topic-0 -> Vector(0))) (kafka.controller.KafkaController)
[2020-04-18 14:42:53,724] DEBUG [Controller id=0] Topics not in preferred replica for broker 0 Map() (kafka.controller.KafkaController)
[2020-04-18 14:42:53,724] TRACE [Controller id=0] Leader imbalance ratio for broker 0 is 0.0 (kafka.controller.KafkaController)
[2020-04-18 14:47:53,731] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2020-04-18 14:47:53,739] DEBUG [Controller id=0] Preferred replicas by broker Map(0 -> Map(sellerProfileService-0 -> Vector(0), adminProductService-0 -> Vector(0), customerProfile-0 -> Vector(0), sellerProductService-0 -> Vector(0), passport-0 -> Vector(0), profile-0 -> Vector(0), response_topic_amazon-0 -> Vector(0), customerProductService-0 -> Vector(0), accounts-0 -> Vector(0), response_topic-0 -> Vector(0))) (kafka.controller.KafkaController)
[2020-04-18 14:47:53,740] DEBUG [Controller id=0] Topics not in preferred replica for broker 0 Map() (kafka.controller.KafkaController)
[2020-04-18 14:47:53,740] TRACE [Controller id=0] Leader imbalance ratio for broker 0 is 0.0 (kafka.controller.KafkaController)
[2020-04-18 14:52:53,748] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2020-04-18 14:52:53,755] DEBUG [Controller id=0] Preferred replicas by broker Map(0 -> Map(sellerProfileService-0 -> Vector(0), adminProductService-0 -> Vector(0), customerProfile-0 -> Vector(0), sellerProductService-0 -> Vector(0), passport-0 -> Vector(0), profile-0 -> Vector(0), response_topic_amazon-0 -> Vector(0), customerProductService-0 -> Vector(0), accounts-0 -> Vector(0), response_topic-0 -> Vector(0))) (kafka.controller.KafkaController)
[2020-04-18 14:52:53,756] DEBUG [Controller id=0] Topics not in preferred replica for broker 0 Map() (kafka.controller.KafkaController)
[2020-04-18 14:52:53,756] TRACE [Controller id=0] Leader imbalance ratio for broker 0 is 0.0 (kafka.controller.KafkaController)
[2020-04-18 14:57:53,768] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2020-04-18 14:57:53,838] DEBUG [Controller id=0] Preferred replicas by broker Map(0 -> Map(sellerProfileService-0 -> Vector(0), adminProductService-0 -> Vector(0), customerProfile-0 -> Vector(0), sellerProductService-0 -> Vector(0), passport-0 -> Vector(0), profile-0 -> Vector(0), response_topic_amazon-0 -> Vector(0), customerProductService-0 -> Vector(0), accounts-0 -> Vector(0), response_topic-0 -> Vector(0))) (kafka.controller.KafkaController)
[2020-04-18 14:57:53,842] DEBUG [Controller id=0] Topics not in preferred replica for broker 0 Map() (kafka.controller.KafkaController)
[2020-04-18 14:57:53,843] TRACE [Controller id=0] Leader imbalance ratio for broker 0 is 0.0 (kafka.controller.KafkaController)
